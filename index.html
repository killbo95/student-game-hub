<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GameHub â€“ Scratch + HTML + Python Games</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f4f4f4;margin:0;padding:0;}
    header{background:#222;color:#fff;padding:15px;text-align:center;font-size:24px;font-weight:bold;}
    #container{display:flex;flex-wrap:wrap;padding:20px;gap:20px;}
    .game-card{background:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.2);width:280px;}
    .game-card h3{margin-top:0;}
    .player iframe{width:100%;height:210px;border:none;border-radius:8px;}
    .btn{display:inline-block;margin-top:10px;padding:6px 12px;background:#222;color:#fff;border:none;border-radius:4px;cursor:pointer;}
    .btn:hover{background:#444;}
    #uploadSection{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.2);margin:20px;}
    #library{padding:20px;}
    #library h2{text-align:center;margin-top:0;}
    label{display:block;margin-top:10px;}
  </style>
</head>
<body>
<header>ðŸŽ® GameHub â€“ Play & Share Games</header>

<div id="uploadSection">
  <h2>Add a New Game</h2>
  <label>Game Name</label>
  <input id="gameName" type="text" placeholder="My Cool Game">
  <label>Type</label>
  <select id="gameType">
    <option value="scratch">Scratch</option>
    <option value="html">HTML</option>
    <option value="python">Python</option>
  </select>

  <div id="scratchInput">
    <label>Scratch Project ID (numbers only)</label>
    <input id="scratchID" type="text" placeholder="e.g. 123456789">
  </div>

  <div id="htmlInput" style="display:none">
    <label>Upload HTML File</label>
    <input id="htmlfile" type="file" accept=".html">
  </div>

  <div id="pythonInput" style="display:none">
    <label>Upload Python File</label>
    <input id="pyfile" type="file" accept=".py">
  </div>

  <button class="btn" id="addBtn">Add to Library</button>
</div>

<section id="library">
  <h2>ðŸŽ¯ Game Library</h2>
  <div id="container"></div>
</section>

<script>
  const container = document.getElementById('container');
  const typeSel = document.getElementById('gameType');
  const scratchInput = document.getElementById('scratchInput');
  const htmlInput = document.getElementById('htmlInput');
  const pythonInput = document.getElementById('pythonInput');

  typeSel.addEventListener('change', ()=>{
    scratchInput.style.display = typeSel.value==='scratch' ? 'block':'none';
    htmlInput.style.display = typeSel.value==='html' ? 'block':'none';
    pythonInput.style.display = typeSel.value==='python' ? 'block':'none';
  });

  let library = JSON.parse(localStorage.getItem('gamehub_library') || '[]');

  function saveLibrary(){ localStorage.setItem('gamehub_library', JSON.stringify(library)); }

  function renderLibrary(){
    container.innerHTML = '';
    library.forEach((g, i)=>{
      const card = document.createElement('div');
      card.className='game-card';
      card.innerHTML = `<h3>${g.name}</h3><div class="player"></div>`;
      const player = card.querySelector('.player');

      if(g.type==='scratch'){
        player.innerHTML = `<iframe src="https://turbowarp.org/${g.payload.id}/embed?autostart=false&fps=60" allowfullscreen></iframe>`;
      }
      else if(g.type==='html'){
        const blob = new Blob([g.payload.html],{type:'text/html'});
        player.innerHTML = `<iframe src="${URL.createObjectURL(blob)}"></iframe>`;
      }
      else if(g.type==='python'){
        player.innerHTML = `<p>Python file: ${g.payload.name}</p>`;
        const d=document.createElement('a');
        d.href=URL.createObjectURL(new Blob([g.payload.code],{type:'text/x-python'}));
        d.download=g.payload.name;
        d.textContent='Download Python File';
        d.className='btn';
        player.appendChild(d);
      }

      const del=document.createElement('button');
      del.className='btn';
      del.textContent='Delete';
      del.onclick=()=>{library.splice(i,1);saveLibrary();renderLibrary();};
      card.appendChild(del);

      container.appendChild(card);
    });
  }

  async function fileToText(file){ return await file.text(); }

  document.getElementById('addBtn').addEventListener('click', async ()=>{
    const name = document.getElementById('gameName').value.trim();
    const type = typeSel.value;
    if(!name){ alert('Please enter a game name'); return; }

    let payload = {};
    if(type==='scratch'){
      const id = document.getElementById('scratchID').value.trim();
      if(!/^\d+$/.test(id)){ alert('Enter numeric Scratch Project ID'); return; }
      payload = {id};
    }
    else if(type==='html'){
      const file = document.getElementById('htmlfile').files[0];
      if(!file){ alert('Upload an HTML file'); return; }
      payload = {html: await fileToText(file)};
    }
    else if(type==='python'){
      const file = document.getElementById('pyfile').files[0];
      if(!file){ alert('Upload a Python file'); return; }
      payload = {name:file.name, code: await fileToText(file)};
    }

    library.push({name,type,payload});
    saveLibrary();
    renderLibrary();
    document.getElementById('gameName').value='';
    document.getElementById('scratchID').value='';
    document.getElementById('htmlfile').value='';
    document.getElementById('pyfile').value='';
  });

  // âœ… Add default games if library is empty
  if(library.length === 0){
    library = [
      { name:'99 Night', type:'scratch', payload:{id:'1212535196'} },
      { name:'Grow a Garden', type:'scratch', payload:{id:'1195673692'} }
    ];
    saveLibrary();
  }

  renderLibrary();
</script>
</body>
</html>
